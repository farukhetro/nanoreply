[{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\api\\callback\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\api\\gbp-connect\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\api\\locations\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\auth\\callback\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\dashboard\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\dashboard\\payment\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\dashboard\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\dashboard\\upgrade\\page.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: This value cannot be modified\n\nModifying a variable defined outside a component or hook is not allowed. Consider using an effect.\n\nC:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\dashboard\\upgrade\\page.tsx:18:17\n  16 |             if (typeof window !== 'undefined') {\n  17 |                 // eslint-disable-next-line react-hooks/immutability\n> 18 |                 window.location.href = \"mailto:sales@nanoreply.com\";\n     |                 ^^^^^^^^^^^^^^^ value cannot be modified\n  19 |             }\n  20 |             return;\n  21 |         }","line":18,"column":17,"nodeType":null,"endLine":18,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\icon.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\legal\\dpa\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\legal\\privacy\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\legal\\terms\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\login\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\app\\register\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\GbpConnect.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":71,"column":9,"severity":1,"nodeType":null,"fix":{"range":[2407,2462],"text":" "}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport Image from \"next/image\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Store, MapPin, Loader2, CheckCircle2, AlertCircle } from \"lucide-react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\ninterface Location {\r\n    name: string; // resource name\r\n    title: string;\r\n    storeCode?: string;\r\n    metadata?: {\r\n        placeId?: string;\r\n        mapsUri?: string;\r\n    };\r\n}\r\n\r\nexport default function GbpConnect() {\r\n    const [loading, setLoading] = useState(false);\r\n    const [locations, setLocations] = useState<Location[]>([]);\r\n    const [isConnected, setIsConnected] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const pollInterval = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    // Cleanup polling on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            if (pollInterval.current) clearInterval(pollInterval.current);\r\n        }\r\n    }, []);\r\n\r\n    const checkConnection = async () => {\r\n        try {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n\r\n            if (!session) return;\r\n\r\n            const response = await fetch(\"/api/locations\", {\r\n                headers: {\r\n                    Authorization: `Bearer ${session.access_token}`,\r\n                },\r\n            });\r\n\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                if (data.locations) {\r\n                    setLocations(data.locations);\r\n                    setIsConnected(true);\r\n                    // Stop polling if we found locations/connection\r\n                    if (pollInterval.current) {\r\n                        clearInterval(pollInterval.current);\r\n                        pollInterval.current = null;\r\n                    }\r\n                    setLoading(false); // Ensure loading is off\r\n                }\r\n            } else {\r\n                const data = await response.json();\r\n                if (data.error && data.error.includes(\"No tokens found\")) {\r\n                    setIsConnected(false);\r\n                }\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error(\"Error checking connection:\", error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        checkConnection();\r\n\r\n        // Listen for message from popup\r\n        const handleMessage = (event: MessageEvent) => {\r\n            if (event.origin !== window.location.origin) return;\r\n            if (event.data === \"gbp-connected\") {\r\n                checkConnection();\r\n            }\r\n        };\r\n\r\n        window.addEventListener(\"message\", handleMessage);\r\n        return () => window.removeEventListener(\"message\", handleMessage);\r\n    }, []);\r\n\r\n\r\n    const handleConnect = async () => {\r\n        try {\r\n            setLoading(true);\r\n            setError(null);\r\n            const response = await fetch(\"/api/gbp-connect\");\r\n            const data = await response.json();\r\n\r\n            if (data.url) {\r\n                const width = 500;\r\n                const height = 600;\r\n                const left = window.screen.width / 2 - width / 2;\r\n                const top = window.screen.height / 2 - height / 2;\r\n\r\n                window.open(\r\n                    data.url,\r\n                    \"Google Connect\",\r\n                    `width=${width},height=${height},top=${top},left=${left}`\r\n                );\r\n\r\n                // Start polling for results\r\n                if (pollInterval.current) clearInterval(pollInterval.current);\r\n                pollInterval.current = setInterval(checkConnection, 3000);\r\n\r\n            } else {\r\n                setError(\"Failed to get authorization URL\");\r\n                setLoading(false);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error initiating connection:\", error);\r\n            setError(\"Failed to initiate connection\");\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Card>\r\n            <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                    <Store className=\"h-5 w-5 text-primary\" />\r\n                    Google Business Profile\r\n                </CardTitle>\r\n                <CardDescription>\r\n                    Connect your Google Business Profile to automate posts and replies.\r\n                </CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n                {error && (\r\n                    <div className=\"mb-4 p-3 bg-destructive/10 text-destructive rounded-md flex items-center gap-2 text-sm\">\r\n                        <AlertCircle className=\"h-4 w-4\" />\r\n                        {error}\r\n                    </div>\r\n                )}\r\n\r\n                {!isConnected ? (\r\n                    <Button onClick={handleConnect} disabled={loading} className=\"w-full sm:w-auto\">\r\n                        {loading ? <Loader2 className=\"h-4 w-4 animate-spin mr-2\" /> : <Image src=\"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg\" alt=\"Google\" width={16} height={16} className=\"h-4 w-4 mr-2\" />}\r\n                        {loading ? \"Connecting...\" : \"Connect Google Account\"}\r\n                    </Button>\r\n                ) : (\r\n                    <div className=\"space-y-4\">\r\n                        <div className=\"flex items-center gap-2 text-green-600 bg-green-50 p-2 rounded-md\">\r\n                            <CheckCircle2 className=\"h-5 w-5\" />\r\n                            <span className=\"font-medium\">Connected</span>\r\n                        </div>\r\n\r\n                        {locations.length > 0 ? (\r\n                            <div className=\"grid gap-2\">\r\n                                {locations.map((loc, idx) => (\r\n                                    <div key={idx} className=\"flex items-center justify-between p-3 border rounded-lg bg-card\">\r\n                                        <div className=\"flex items-center gap-3\">\r\n                                            <MapPin className=\"h-4 w-4 text-muted-foreground\" />\r\n                                            <div>\r\n                                                <p className=\"font-medium text-sm\">{loc.title}</p>\r\n                                                <p className=\"text-xs text-muted-foreground\">{loc.storeCode || \"No store code\"}</p>\r\n                                                {loc.metadata?.mapsUri && (\r\n                                                    <a href={loc.metadata.mapsUri} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-xs text-primary hover:underline\">\r\n                                                        View on Maps\r\n                                                    </a>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                        <Button variant=\"outline\" size=\"sm\">Manage</Button>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"p-4 border rounded-md text-center bg-muted/20\">\r\n                                <p className=\"text-sm text-muted-foreground\">No locations found for this account.</p>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"pt-2\">\r\n                            <Button variant=\"ghost\" size=\"sm\" onClick={handleConnect} className=\"text-muted-foreground hover:text-foreground\">\r\n                                Reconnect Account\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\providers\\theme-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\providers\\toast-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\fade-in.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\logo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\lib\\countries.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\lib\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\lib\\supabase\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\lib\\supabase\\server.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\User\\OneDrive\\Documents\\TESTING\\GOOGLE BUSINESS\\nanoreply-frontend\\src\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]